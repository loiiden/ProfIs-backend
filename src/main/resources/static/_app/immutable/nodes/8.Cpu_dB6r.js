import{a as D,b as pe,P as fe}from"../chunks/CiZ-rBY8.js";import"../chunks/DsnmJJEf.js";import{aU as Ye,d as Je,h as R,n as Qe,aZ as me,x as Xe,k as et,y as tt,j as ee,W as at,q as rt,A as te,G as he,F as _e,a_ as st,a$ as nt,b0 as it,b1 as lt,aB as ot,b2 as ct,a0 as ye,a1 as Se,a2 as w,a6 as n,aa as P,a4 as g,a5 as Be,o as a,a8 as M,a3 as r,a7 as s,ab as N,ac as m,ai as dt,ad as W,e as vt,aT as ut,a9 as pt,aR as ge,aW as ft}from"../chunks/C-QRPYMU.js";import{i as ae}from"../chunks/D6BGfUMK.js";import{e as se,i as ne}from"../chunks/DLRb4NzI.js";import{h as mt}from"../chunks/DEZGI6pG.js";import{r as be}from"../chunks/BvaJcb-S.js";import{s as ht}from"../chunks/B_MYmuK7.js";import{b as ke}from"../chunks/aiiB4YHO.js";import{b as _t}from"../chunks/C0v469Pt.js";import{E as gt}from"../chunks/cqce9B6v.js";import{i as T}from"../chunks/CtAzj6bH.js";const we=0,re=1;function bt(y,u,d,k,_){R&&Qe();var p=Ye(),o=ct,S=p?he(o):_e(o,!1,!1),A=p?he(o):_e(o,!1,!1),B=new at(y);Je(()=>{var x=u(),c=!1;let h=R&&me(x)===(y.data===Xe);if(h&&(et(tt()),ee(!1)),me(x)){var b=st(),l=!1;const f=v=>{if(!c){l=!0,b(!1),nt.ensure(),R&&ee(!1);try{v()}finally{it(),lt||ot()}}};x.then(v=>{f(()=>{te(S,v),B.ensure(re,k&&(L=>k(L,S)))})},v=>{f(()=>{if(te(A,v),B.ensure(re,_&&(L=>_(L,A))),!_)throw A.v})}),R?B.ensure(we,d):rt(()=>{l||f(()=>{B.ensure(we,d)})})}else te(S,x),B.ensure(re,k&&(f=>k(f,S)));return h&&ee(!0),()=>{c=!0}})}const wt=!1,yt=async({fetch:y})=>{const d=await(await y(`${D}/api/evaluator`)).json(),_=await(await y(`${D}/api/study-program`)).json();let p=null;try{const o=await y(`${D}/api/evaluator/main-user`);o.ok&&(p=await o.json())}catch(o){console.warn("Konnte aktuellen Benutzer nicht laden:",o)}return{referenten:d,studyPrograms:_,currentUser:p}},$t=Object.freeze(Object.defineProperty({__proto__:null,load:yt,ssr:wt},Symbol.toStringTag,{value:"Module"}));var St=w("<option> </option>"),Bt=w('<select style="width: 100%" class="svelte-m58xs3"></select>'),kt=w("<p>Lädt...</p>"),xt=w('<div class="card report-section svelte-m58xs3"><div class="headline-s svelte-m58xs3">Bericht erstellen</div> <p class="description svelte-m58xs3">Hier können Sie Semesterwochenstunden-Berichte erstellen.<br/></p> <div class="row select-and-button-wrapper svelte-m58xs3" style="justify-content: space-between;"><div style="width: 70%;"><!></div> <div><button class="btn svelte-m58xs3">Bericht herunterladen</button></div></div></div>');function Et(y,u){Se(u,!0);let d=M("");async function k(){try{let c=await fetch(`${D}/api/sws/semestersToSelect`,{method:"GET"});if(!c.ok)throw new Error("Fetch failed");const h=await c.json();return h.length>0&&m(d,h[0],!0),h}catch(c){console.error("Error fetching semesters:",c)}}async function _(){try{if(a(d)===""){alert("Bitte wählen Sie ein Semester aus.");return}let c=await fetch(`${D}/api/sws/main-user/report/${a(d)}`,{method:"GET"});if(!c.ok)throw new Error("Download failed");const h=await c.blob(),b=window.URL.createObjectURL(h),l=document.createElement("a");l.href=b,l.download=`SWS_Bericht_${a(d)}.pdf`,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(b)}catch(c){console.error("Error downloading PDF:",c),alert("PDF-Bericht konnte nicht erstellt werden.")}}var p=xt(),o=r(n(p),4),S=n(o),A=n(S);bt(A,k,c=>{var h=kt();g(c,h)},(c,h)=>{var b=Bt();se(b,21,()=>a(h),ne,(l,f)=>{var v=St(),L=n(v,!0);s(v);var I={};P(()=>{N(L,a(f)),I!==(I=a(f))&&(v.value=(v.__value=a(f))??"")}),g(l,v)}),s(b),ke(b,()=>a(d),l=>m(d,l)),g(c,b)}),s(S);var B=r(S,2),x=n(B);x.__click=_,s(B),s(o),s(p),P(()=>x.disabled=!u.active),g(y,p),Be()}ye(["click"]);var Dt=w("<br/><br/> <strong>Aktuell eingestellt:</strong> ",1),At=w('<div class="program-row svelte-1i19ct2"><span class="program-name svelte-1i19ct2"> </span> <button class="delete-btn svelte-1i19ct2">Löschen</button></div>'),Lt=w('<div class="empty-programs svelte-1i19ct2">Keine Studiengänge vorhanden.</div>'),Mt=w('<option class="svelte-1i19ct2"> </option>'),Pt=w('<span class="dropzone-text svelte-1i19ct2"> </span>'),Tt=w('<span class="dropzone-text dropzone-placeholder svelte-1i19ct2">Excel-Datei auswählen / Drag & Drop</span>'),It=w('<main class="settings-container svelte-1i19ct2"><div class="page-header svelte-1i19ct2"><div class="page-title svelte-1i19ct2">EINSTELLUNGEN</div> <a href="settings/user-documentation" class="help-btn svelte-1i19ct2">Hilfe</a></div> <div class="card user-section svelte-1i19ct2"><div class="headline-s svelte-1i19ct2">Benutzer auswählen</div> <p class="description svelte-1i19ct2">Wählen Sie hier Ihren Namen als Benutzer aus. <!></p> <div class="input-row svelte-1i19ct2"><div class="search-wrapper svelte-1i19ct2"><!></div> <button class="save-btn svelte-1i19ct2">Speichern</button></div></div> <div class="card program-section svelte-1i19ct2"><div class="headline-s svelte-1i19ct2">Studiengänge verwalten</div> <div class="program-list svelte-1i19ct2"><div class="list-header svelte-1i19ct2"><span></span> <span></span></div> <!></div> <div class="add-row svelte-1i19ct2"><input class="input-title svelte-1i19ct2" type="text" placeholder="Titel (z.B. Softwaretechnologie)"/> <input class="input-sws svelte-1i19ct2" type="number" placeholder="SWS" min="0" step="0.1" inputmode="decimal"/>  <select class="input-degree svelte-1i19ct2" required><option disabled selected class="svelte-1i19ct2">Abschluss wählen</option><!></select> <button class="add-btn svelte-1i19ct2">+</button></div></div>  <div class="card excel-section svelte-1i19ct2"><div class="headline-s svelte-1i19ct2">Daten Import/Export</div> <div class="excel-row svelte-1i19ct2"><div><input type="file" accept=".xlsx" style="display: none;"/> <!></div> <button class="save-btn svelte-1i19ct2">Importieren</button></div> <div class="excel-row svelte-1i19ct2" style="margin-top: 10px;"><span class="export-label svelte-1i19ct2">Datenbankstand sichern:</span> <button class="secondary-btn svelte-1i19ct2">Exportieren</button></div></div> <!>  <div class="card danger-section svelte-1i19ct2"><div class="headline-s danger-title svelte-1i19ct2">ProfIS zurücksetzen</div> <p class="description svelte-1i19ct2">Hier können Sie alle Daten in ProfIS vollständig löschen.<br/> Dabei werden sämtliche gespeicherten Informationen unwiderruflich gelöscht.<br/><br/> Wenn Sie die Daten später noch benötigen, exportieren Sie diese bitte vorher als Backup. Bitte beachten Sie, dass Events nicht mitgesichert werden.<br/><br/> <strong class="danger-warning svelte-1i19ct2">Diese Aktion kann nicht rückgängig gemacht werden.</strong></p> <button class="danger-btn svelte-1i19ct2">Alle Daten löschen</button></div></main>');function qt(y,u){Se(u,!0);let d=M(dt(u.data.currentUser||null));async function k(){if(!a(d))return;(await fe(`/api/evaluator/main-user/${a(d).id}`)).ok?T():alert("Fehler beim Speichern des Benutzers.")}let _=M(""),p=M(""),o=M("");const S=[{value:"B_A",label:"Bachelor of Arts (B.A.)"},{value:"B_ENG",label:"Bachelor of Engineering (B.Eng.)"},{value:"B_SC",label:"Bachelor of Science (B.Sc.)"},{value:"B_LAWS",label:"Bachelor of Laws (LL.B.)"},{value:"BBA",label:"Bachelor of Business Admin. (BBA)"},{value:"M_A",label:"Master of Arts (M.A.)"},{value:"M_SC",label:"Master of Science (M.Sc.)"},{value:"M_ENG",label:"Master of Engineering (M.Eng.)"},{value:"M_LAWS",label:"Master of Laws (LL.M.)"},{value:"MBA",label:"Master of Business Admin. (MBA)"}],A={B_A:"B.A.",B_ENG:"B.Eng.",B_SC:"B.Sc.",B_LAWS:"LL.B.",BBA:"BBA",M_A:"M.A.",M_SC:"M.Sc.",M_ENG:"M.Eng.",M_LAWS:"LL.M.",MBA:"MBA"};function B(e){return A[e]||e||""}function x(e){const t=(e?.title||"").trim(),i=B(e?.degreeType);return i?`${i} in ${t}`:t}function c(){return Array.isArray(u.data?.studyPrograms)&&u.data.studyPrograms.length>0}async function h(){if(a(_).trim()===""||a(p)===""||a(o)===""){alert("Bitte alle Felder (Titel, SWS, Abschluss) ausfüllen.");return}let e={title:a(_),sws:Number(a(p)),degreeType:a(o)};(await fe("/api/study-program",e)).ok?(m(_,""),m(p,""),m(o,""),T()):alert("Fehler beim Hinzufügen.")}async function b(e){try{(await fetch(`${D}/api/study-program/${e}`,{method:"DELETE"})).ok?T():alert("Konnte nicht gelöscht werden.")}catch(t){console.error(t),alert("Verbindungsfehler beim Löschen.")}}let l=M(null),f=M(!1),v;function L(){v?.click()}function I(e){if(!e)return;if(!(e?.name||"").toLowerCase().endsWith(".xlsx")){alert("Bitte eine .xlsx Datei auswählen.");return}m(l,e,!0)}function xe(e){const t=e?.target?.files?.[0];I(t)}function Ee(e){e.preventDefault(),m(f,!0)}function De(e){e.preventDefault(),m(f,!0)}function Ae(e){e.preventDefault(),m(f,!1)}function Le(e){e.preventDefault(),m(f,!1);const t=e?.dataTransfer?.files?.[0];I(t)}async function Me(){if(!a(l)){alert("Bitte wählen Sie eine Excel-Datei aus.");return}try{const e=new FormData;e.append("excelFile",a(l));let t=await fetch(`${D}/api/data/import`,{method:"POST",body:e});if(t.ok){let i=await t.text();i&&i.trim()==="Successfully imported Excel data to database"?alert("Excel-Daten wurden erfolgreich importiert!"):alert(i||"Import erfolgreich!"),m(l,null),v&&(v.value=""),T()}else{let i="";try{i=await t.text()}catch{}alert(i?`Fehler beim Importieren: ${i}`:"Fehler beim Importieren.")}}catch(e){console.error(e),alert("Verbindungsfehler beim Import.")}}function Pe(){window.open(`${D}/api/data/export`,"_blank")}async function Te(){if(confirm("Sind Sie sicher, dass Sie alle Daten löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden!"))try{(await fetch(`${D}/api/data/reset`,{method:"DELETE"})).ok?(alert("Datenbank wurde erfolgreich zurückgesetzt."),T(),window.location.reload()):(alert("Fehler beim Zurücksetzen der Datenbank."),T(),window.location.reload())}catch(e){console.error(e),alert("Verbindungsfehler beim Zurücksetzen.")}}var j=It();mt("1i19ct2",e=>{vt(()=>{ut.title="Einstellungen - ProfIS"})});var G=r(n(j),2),O=r(n(G),2),Ie=r(n(O));{var ze=e=>{var t=Dt(),i=r(ge(t),4);P(()=>N(i,` ${u.data.currentUser.firstName??""} ${u.data.currentUser.lastName??""}`)),g(e,t)};ae(Ie,e=>{u.data.currentUser&&e(ze)})}s(O);var ie=r(O,2),C=n(ie),Ne=n(C);gt(Ne,{get data(){return u.data.referenten},placeholder:"Benutzer/Referent suchen...",get selectedEvaluator(){return a(d)},set selectedEvaluator(e){m(d,e,!0)}}),s(C);var Fe=r(C,2);Fe.__click=k,s(ie),s(G);var H=r(G,2),Z=r(n(H),2),Ue=r(n(Z),2);{var Re=e=>{var t=ft(),i=ge(t);se(i,17,()=>u.data.studyPrograms,ne,(U,z)=>{var Q=At(),X=n(Q),qe=n(X,!0);s(X);var Ke=r(X,2);Ke.__click=()=>b(a(z).id),s(Q),P(Ve=>N(qe,Ve),[()=>x(a(z))]),g(U,Q)}),g(e,t)},We=e=>{var t=Lt();g(e,t)};ae(Ue,e=>{c()?e(Re):e(We,!1)})}s(Z);var le=r(Z,2),$=n(le);be($);var q=r($,2);be(q);var F=r(q,2),K=n(F);K.value=K.__value="";var je=r(K);se(je,17,()=>S,ne,(e,t)=>{var i=Mt(),U=n(i,!0);s(i);var z={};P(()=>{N(U,a(t).label),z!==(z=a(t).value)&&(i.value=(i.__value=a(t).value)??"")}),g(e,i)}),s(F);var Ge=r(F,2);Ge.__click=h,s(le),s(H);var V=r(H,2),Y=r(n(V),2),E=n(Y);let oe;E.__click=L;var J=n(E);J.__change=xe,_t(J,e=>v=e,()=>v);var Oe=r(J,2);{var Ce=e=>{var t=Pt(),i=n(t,!0);s(t),P(()=>N(i,a(l).name)),g(e,t)},He=e=>{var t=Tt();g(e,t)};ae(Oe,e=>{a(l)?e(Ce):e(He,!1)})}s(E);var ce=r(E,2);ce.__click=Me,s(Y);var de=r(Y,2),Ze=r(n(de),2);Ze.__click=Pe,s(de),s(V);var ve=r(V,2);{let e=pt(()=>a(d)!==null);Et(ve,{get active(){return a(e)}})}var ue=r(ve,2),$e=r(n(ue),4);$e.__click=Te,s(ue),s(j),P(()=>{oe=ht(E,1,"dropzone svelte-1i19ct2",null,oe,{dragover:a(f)}),ce.disabled=!a(l)}),pe($,()=>a(_),e=>m(_,e)),pe(q,()=>a(p),e=>m(p,e)),ke(F,()=>a(o),e=>m(o,e)),W("dragenter",E,Ee),W("dragover",E,De),W("dragleave",E,Ae),W("drop",E,Le),g(y,j),Be()}ye(["click","change"]);export{qt as component,$t as universal};
