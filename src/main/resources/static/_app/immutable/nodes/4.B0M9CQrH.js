import{a as Ue,b as C,G as _e,P as Wt,c as Bt,D as Xt}from "../chunks/CiZ-rBY8.js";import"../chunks/DsnmJJEf.js";import{a0 as Ze,a1 as pe,a2 as T,a3 as n,aa as R,a4 as A,a5 as ge,a6 as r,ai as ue,a7 as l,b4 as Ft,o as e,a9 as O,ab as X,a8 as P,ac as u,ad as Y,av as le,aY as ea,aT as ta}from "../chunks/C-QRPYMU.js";import{h as aa}from "../chunks/DEZGI6pG.js";import{a as la,g as jt}from "../chunks/zXmO40Ci.js";import{s as ra,O as na}from "../chunks/DKf03ZXI.js";import{r as W,s as Vt,a as ia,b as sa}from "../chunks/BvaJcb-S.js";import{s as Rt}from "../chunks/B_MYmuK7.js";import{p as z}from "../chunks/CN1D4ans.js";import{E as Lt}from "../chunks/C8lPctu5.js";import{o as oa}from "../chunks/DLbg6C1x.js";import{i as re}from "../chunks/D6BGfUMK.js";import{e as he,i as be}from "../chunks/DLRb4NzI.js";import{i as $t,s as Ot}from "../chunks/aiiB4YHO.js";import{s as va}from "../chunks/BJYZ7QGz.js";const ua=!1,da=async({fetch:V})=>{try{const p=await V(`${Ue}/api/evaluator`);if(p.ok){const a=await p.json();let d=await V(`${Ue}/api/study-program`);const g=await d.json();d=await V(`${Ue}/api/student`);const D=await d.json();return{referenten:a,students:D,study_programs:g}}else return console.error("Fehler beim Laden der Referenten:",p.status),{referenten:[]}}catch(p){return console.error("Server nicht erreichbar:",p),{referenten:[]}}},Ya=Object.freeze(Object.defineProperty({__proto__:null,load:da,ssr:ua},Symbol.toStringTag,{value:"Module"}));var ca=T('<div class="erfassen-noten-container svelte-1iqql48"><div class="block"><div class="main-label svelte-1iqql48">Referent</div> <div class="search-row svelte-1iqql48"><!></div> <div class="grades-row svelte-1iqql48"><div class="grade-group svelte-1iqql48"><span class="grade-label svelte-1iqql48">Punkte<br/>Arbeit:</span> <input type="number" class="grade-input svelte-1iqql48" placeholder="-" min="0" max="100" step="1"/></div> <div class="grade-group svelte-1iqql48"><span class="grade-label svelte-1iqql48">Punkte<br/>Kolloquium:</span> <input type="number" class="grade-input svelte-1iqql48" placeholder="-" min="0" max="100" step="1"/></div></div></div> <div class="block"><div class="main-label svelte-1iqql48">Korreferent</div> <div class="search-row svelte-1iqql48"><!></div> <div class="grades-row svelte-1iqql48"><div class="grade-group svelte-1iqql48"><span class="grade-label svelte-1iqql48">Punkte<br/>Arbeit:</span> <input type="number" class="grade-input svelte-1iqql48" placeholder="-" min="0" max="100" step="1"/></div> <div class="grade-group svelte-1iqql48"><span class="grade-label svelte-1iqql48">Punkte<br/>Kolloquium:</span> <input type="number" class="grade-input svelte-1iqql48" placeholder="-" min="0" max="100" step="1"/></div></div></div> <div class="block footer-block svelte-1iqql48"><div class="left-col svelte-1iqql48"><div class="main-label svelte-1iqql48">Kommentar</div> <textarea class="comment-box svelte-1iqql48"></textarea></div> <div class="right-col svelte-1iqql48"><div class="total-wrapper svelte-1iqql48"><div class="total-label svelte-1iqql48">Gesamtpunkte<br/>der Arbeit:</div> <div> </div></div></div></div></div>');function ma(V, p){pe(p,!0);let a=z(p,"evaluators",19,()=>[]),d=z(p,"data",31,()=>ue({mainEvaluator:null,secondEvaluator:null,mainEvaluatorWorkMark:null,mainEvaluatorColloquiumMark:null,secondEvaluatorWorkMark:null,secondEvaluatorColloquiumMark:null,comment:""}));function g(s){let i=s.target.value;if(i==="")return;let I=Number(i);(I<0||I>100||!Number.isInteger(I)||i.includes(".")||i.includes(","))&&(s.target.value="")}let D=O(()=>{const i=[d().mainEvaluatorWorkMark,d().mainEvaluatorColloquiumMark,d().secondEvaluatorWorkMark,d().secondEvaluatorColloquiumMark].filter(k=>k!==null&&k!==""&&!isNaN(k));return i.length<4?null:(i.reduce((k, ie)=>Number(k)+Number(ie),0)/4).toFixed(1)});function h(s){if(!s)return"";const i=Number(s);return i>=87.5?"mark1":i>=72.5?"mark2":i>=57.5?"mark3":i>=50?"mark4":"mark5"}let v=O(()=>h(e(D)));var b=ca(),w=r(b),N=n(r(w),2),F=r(N);Lt(F,{get data(){return a()},get selectedEvaluator(){return d().mainEvaluator},set selectedEvaluator(s){d(d().mainEvaluator=s,!0)}}),l(N);var J=n(N,2),B=r(J),x=n(r(B),2);W(x),x.__input=g,l(B);var y=n(B,2),G=n(r(y),2);W(G),G.__input=g,l(y),l(J),l(w);var H=n(w,2),U=n(r(H),2),Z=r(U);Lt(Z,{get data(){return a()},get selectedEvaluator(){return d().secondEvaluator},set selectedEvaluator(s){d(d().secondEvaluator=s,!0)}}),l(U);var c=n(U,2),E=r(c),m=n(r(E),2);W(m),m.__input=g,l(E);var f=n(E,2),q=n(r(f),2);W(q),q.__input=g,l(f),l(c),l(H);var j=n(H,2),L=r(j),$=n(r(L),2);Ft($),l(L);var ee=n(L,2),ne=r(ee),Q=n(r(ne),2),de=r(Q,!0);l(Q),l(ne),l(ee),l(j),l(b),R(()=>{Rt(Q,1,`total-box ${e(v)??""}`,"svelte-1iqql48"),X(de,e(D)??"?")}),C(x,()=>d().mainEvaluatorWorkMark, s=>d(d().mainEvaluatorWorkMark=s,!0)),C(G,()=>d().mainEvaluatorColloquiumMark, s=>d(d().mainEvaluatorColloquiumMark=s,!0)),C(m,()=>d().secondEvaluatorWorkMark, s=>d(d().secondEvaluatorWorkMark=s,!0)),C(q,()=>d().secondEvaluatorColloquiumMark, s=>d(d().secondEvaluatorColloquiumMark=s,!0)),C($,()=>d().comment, s=>d(d().comment=s,!0)),A(V,b),ge()}Ze(["input"]);var pa=T('<button class="display-value svelte-1o0j71q" type="button" aria-label="Auswahl ändern"> </button>'),ga=T('<a href="/erstellen/student" target="_blank" class="create-btn svelte-1o0j71q" style="text-decoration: none; display: inline-block; text-align: center;">erstellen</a>'),fa=T('<div class="input-wrapper svelte-1o0j71q"><input type="text" class="svelte-1o0j71q"/> <!></div>'),_a=T('<button class="list-item svelte-1o0j71q" type="button"> </button>'),ha=T('<div class="dropdown-list svelte-1o0j71q"></div>'),ba=T('<div class="search-component svelte-1o0j71q"><div class="search-wrapper svelte-1o0j71q"><div class="input-container svelte-1o0j71q"><!></div> <button class="refresh-btn svelte-1o0j71q" type="button">⟳</button></div> <!></div>');function ya(V, p){pe(p,!0);let a=z(p,"data",19,()=>[]),d=z(p,"placeholder",3,"Student suchen"),g=z(p,"selectedStudent",15,null),D=z(p,"refresh",3,()=>{}),h=z(p,"onClear",3,()=>{}),v=P(""),b=P(!1),w=O(()=>Array.isArray(a())?a():[]),N=O(()=>e(w).filter(m=>`${m.firstName??""} ${m.lastName??""}`.toLowerCase().includes(e(v).toLowerCase())));function F(m){g(m),u(v,`${m.firstName} ${m.lastName}`),u(b,!1)}function J(){g(null),u(v,""),u(b,!0),h()()}var B=ba(),x=r(B),y=r(x),G=r(y);{var H= m=>{var f=pa();f.__click=J;var q=r(f);l(f),R(()=>X(q,`${g().firstName??""} ${g().lastName??""}`)),A(m,f)},U= m=>{var f=fa(),q=r(f);W(q),q.__input=()=>u(b,!0);var j=n(q,2);{var L= $=>{var ee=ga();A($,ee)};re(j, $=>{e(N).length===0&&e(v).length>0&&$(L)})}l(f),R(()=>Vt(q,"placeholder",d())),Y("focus",q,()=>u(b,!0)),C(q,()=>e(v), $=>u(v,$)),A(m,f)};re(G, m=>{g()?m(H):m(U,!1)})}l(y);var Z=n(y,2);Z.__click=()=>D()(),l(x);var c=n(x,2);{var E= m=>{var f=ha();he(f,21,()=>e(N),be,(q, j)=>{var L=_a();L.__click=()=>F(e(j));var $=r(L);l(L),R(()=>X($,`${e(j).firstName??""} ${e(j).lastName??""}`)),A(q,L)}),l(f),A(m,f)};re(c, m=>{e(b)&&!g()&&e(v).length>0&&e(N).length>0&&m(E)})}l(B),A(V,B),ge()}Ze(["click","input"]);var Ea=T('<button class="display-value svelte-mj807v" type="button" aria-label="Auswahl ändern"> </button>'),ka=T('<div class="input-wrapper svelte-mj807v"><input type="text" class="svelte-mj807v"/></div>'),qa=T('<button class="list-item svelte-mj807v" type="button"> </button>'),Sa=T('<div class="dropdown-list svelte-mj807v"></div>'),Ma=T('<div class="search-component svelte-mj807v"><div class="input-container svelte-mj807v"><!></div> <!></div>');function Da(V, p){pe(p,!0);let a=z(p,"data",19,()=>[]),d=z(p,"placeholder",3,"Studiengang suchen"),g=z(p,"selectedStudyProgram",3,null),D=z(p,"onSelected",3,null),h=z(p,"onCleared",3,null),v=P(""),b=P(!1),w=O(()=>Array.isArray(a())?a():[]),N=O(()=>e(w).filter(c=>`${c.title??""}`.toLowerCase().includes(e(v).toLowerCase())));function F(c){typeof D()=="function"&&D()(c),u(v,c.title??"",!0),u(b,!1)}function J(){typeof h()=="function"&&h()(),u(v,""),u(b,!0)}le(()=>{g()&&!e(b)&&u(v,g().title??"",!0)});var B=Ma(),x=r(B),y=r(x);{var G= c=>{var E=Ea();E.__click=J;var m=r(E,!0);l(E),R(()=>X(m,g().title)),A(c,E)},H= c=>{var E=ka(),m=r(E);W(m),m.__input=()=>u(b,!0),l(E),R(()=>Vt(m,"placeholder",d())),Y("focus",m,()=>u(b,!0)),C(m,()=>e(v), f=>u(v,f)),A(c,E)};re(y, c=>{g()?c(G):c(H,!1)})}l(x);var U=n(x,2);{var Z= c=>{var E=Sa();he(E,21,()=>e(N),be,(m, f)=>{var q=qa();q.__click=()=>F(e(f));var j=r(q,!0);l(q),R(()=>X(j,e(f).title)),A(m,q)}),l(E),A(c,E)};re(U, c=>{e(b)&&!g()&&e(v).length>0&&e(N).length>0&&c(Z)})}l(B),A(V,B),ge()}Ze(["click","input"]);var wa=T('<div class="student-studyprogram-hint svelte-1vgudho"><strong> </strong></div>'),Ia=T('<button type="button"> </button>'),Aa=T('<div class="pager svelte-1vgudho"><button type="button" class="pager-arrow svelte-1vgudho">←</button> <!></div>'),Ta=T("<option> </option>"),Pa=T('<button type="button" class="input-shell action-shell remove-shell svelte-1vgudho">entfernen</button>'),xa=T('<div class="erfassen-daten-arbeit-container svelte-1vgudho"><div class="card svelte-1vgudho"><div class="section svelte-1vgudho"><div class="section-title svelte-1vgudho">Student</div> <div class="row-inline student-row svelte-1vgudho"><div class="grow svelte-1vgudho"><!></div></div> <div class="field svelte-1vgudho"><div class="label svelte-1vgudho">Studiengang</div> <!> <!></div></div> <div class="divider svelte-1vgudho"></div> <div class="section svelte-1vgudho"><div class="section-title svelte-1vgudho">Arbeit</div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Titel</div> <div class="input-shell textarea svelte-1vgudho"><textarea placeholder="-" class="svelte-1vgudho"></textarea></div></div> <div class="grid-2 svelte-1vgudho"><div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Startdatum</div> <div class="input-shell svelte-1vgudho"><input type="date" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Abgabedatum</div> <div class="input-shell svelte-1vgudho"><input type="date" class="svelte-1vgudho"/></div></div></div></div> <div class="divider svelte-1vgudho"></div> <div class="section svelte-1vgudho"><div class="section-title svelte-1vgudho">Kolloquiumsprotokoll</div> <div class="grid-3-kollo svelte-1vgudho"><div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Tag</div> <div class="input-shell svelte-1vgudho"><input type="date" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Zeit</div> <div class="input-shell svelte-1vgudho"><input type="time" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Dauer</div> <div class="input-shell svelte-1vgudho"><select class="svelte-1vgudho"><option>Bitte wählen</option><option>30 Min</option><option>45 Min</option><option>1 Std</option><option>1 Std 15 Min</option><option>1 Std 30 Min</option><option>1 Std 45 Min</option><option>2 Std</option><option>2 Std 15 Min</option><option>2 Std 30 Min</option><option>2 Std 45 Min</option><option>3 Std</option></select></div></div></div> <div class="grid-4 svelte-1vgudho"><div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Präsentation von</div> <div class="input-shell svelte-1vgudho"><input type="time" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Präsentation bis</div> <div class="input-shell svelte-1vgudho"><input type="time" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Diskussion von</div> <div class="input-shell svelte-1vgudho"><input type="time" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Diskussion bis</div> <div class="input-shell svelte-1vgudho"><input type="time" class="svelte-1vgudho"/></div></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Kolloquiumsstandort*</div> <div class="input-shell svelte-1vgudho"><input type="text" placeholder="-" class="svelte-1vgudho"/></div></div></div> <div class="divider svelte-1vgudho"></div> <div class="section svelte-1vgudho"><div class="veranstaltung-header svelte-1vgudho"><div class="section-title svelte-1vgudho">Veranstaltung*</div> <!></div> <div class="grid-3-event svelte-1vgudho"><div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Typ</div> <div class="input-shell svelte-1vgudho"><select class="svelte-1vgudho"><option disabled>Bitte wählen</option><!></select></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">Datum</div> <div class="input-shell svelte-1vgudho"><input type="date" class="svelte-1vgudho"/></div></div> <div class="field svelte-1vgudho"><div class="sub-label svelte-1vgudho">&nbsp;</div> <div class="event-actions svelte-1vgudho"><button type="button" class="input-shell action-shell plus-shell svelte-1vgudho">+</button> <!></div></div></div></div></div></div>');function Ca(V, p){pe(p,!0);let a=z(p,"data",31,()=>ue({colloquium:null,colloquiumLocation:"",colloquiumDuration:null,presentationStart:"",presentationEnd:"",discussionStart:"",discussionEnd:"",title:"",startDate:"",endDate:"",studentId:null,studyProgramId:null,mainEvaluatorId:null,secondEvaluatorId:null,mainEvaluatorWorkMark:null,mainEvaluatorColloquiumMark:null,secondEvaluatorWorkMark:null,secondEvaluatorColloquiumMark:null,comment:"",events:[{eventType:"",eventDate:""}]})),d=ue({tag:"",zeit:""}),g=P(""),D=P(ue([])),h=P(null),v=P(ue([])),b=P(null),w=P(null),N=P(""),F=P(!1),J=O(()=>new Map((Array.isArray(e(v))?e(v):[]).map(t=>[t.id,t.title]))),B=O(()=>new Map((Array.isArray(e(v))?e(v):[]).map(t=>[t.id,t.degreeType]))),x=O(()=>e(h)?.studyProgramId?e(J).get(e(h).studyProgramId)??"":""),y=O(()=>e(h)?.studyProgramId?e(B).get(e(h).studyProgramId)??"":"");const G={B_A:"B.A.",B_ENG:"B.Eng.",B_SC:"B.Sc.",B_LAWS:"B.Laws.",BBA:"BBA",M_A:"M.A.",M_SC:"M.Sc.",M_ENG:"M.Eng.",M_LAWS:"M.Laws.",MBA:"MBA"};function H(t){return t?G[t]??String(t).replaceAll("_","."):""}function U(t){const o=t?.title??"",_=H(t?.degreeType);return _&&o?`${_} in ${o}`:_||o||""}let Z=O(()=>(Array.isArray(e(v))?e(v):[]).map(t=>({...t,title:U(t)}))),c=P(0),E=O(()=>(a().events??[]).length),m=O(()=>(a().events?.length??0)>0),f=O(()=>e(m)?(a().events??[])[e(c)]:{eventType:"",eventDate:""});const q=Object.entries(va).map(([t,o])=>({value:t,label:o}));le(()=>{if(a().studentId&&!e(h)&&e(D).length>0){const t=e(D).find(o=>o.id===a().studentId);t&&u(h,t,!0)}}),le(()=>{if(a().studyProgramId&&!e(w)&&e(Z).length>0&&!e(F)){const t=e(Z).find(o=>o.id===a().studyProgramId);t&&(u(w,t,!0),u(b,t.id,!0),u(N,t.title??"",!0))}!a().studyProgramId&&e(w)&&!e(F)&&(u(w,null),u(b,null),u(N,""))}),le(()=>{if(a().colloquium&&(!d.tag||!d.zeit)&&typeof a().colloquium=="string"){const o=a().colloquium.split("T");o.length>=2&&(d.tag=o[0],d.zeit=o[1].substring(0,5))}const t=a().colloquiumDuration;if(t==null||t===0){u(g,"");return}if(typeof t=="number"){u(g,String(Math.round(t/60)),!0);return}if(typeof t=="string"){const o=t.match(/\d+/);u(g,o?o[0]:"",!0)}}),le(()=>{const t=e(h)?.id??null;t!==null&&a(a().studentId=t,!0)});function j(t){if(t==null||t==="-"||t==="")return null;let o=t;if(typeof o=="string"){if(o=o.trim(),o==="-"||o==="")return null;o=o.replace(",",".")}const _=Number(o);if(!Number.isFinite(_))return null;const K=Math.trunc(_);return K<0||K>100?null:K}le(()=>{["mainEvaluatorWorkMark","mainEvaluatorColloquiumMark","secondEvaluatorWorkMark","secondEvaluatorColloquiumMark"].forEach(o=>{if(a()&&a()[o]!==void 0){const _=j(a()[o]);a()[o]!==_&&a(a()[o]=_,!0)}})});function L(t){u(w,t,!0),a(a().studyProgramId=t?.id??null,!0),u(F,!0)}function $(){u(w,null),a(a().studyProgramId=null,!0),u(F,!0)}le(()=>{if(!d.tag||!d.zeit){if(!a().colloquium)return}else a(a().colloquium=`${d.tag}T${d.zeit}`,!0)});function ee(t){u(g,t,!0);const o=Number(t);a(a().colloquiumDuration=Number.isFinite(o)&&o>0?o*60:null,!0)}function ne(){a(a().studentId=null,!0),u(h,null)}function Q(){a(a().events=[...a().events??[],{eventType:"",eventDate:""}],!0),u(c,(a().events?.length??1)-1)}function de(){const t=a().events??[];if(t.length===0)return;const _=t.filter((K, te)=>te!==e(c));a(a().events=_,!0),_.length===0?u(c,0):u(c,Math.min(e(c),_.length-1),!0)}function s(t){const o=a().events?.length??0;t<0||t>=o||u(c,t,!0)}function i(){(Array.isArray(a().events)?a().events:[]).length===0&&(a(a().events=[{eventType:"",eventDate:""}],!0),u(c,0))}function I(t){i();const o=[...a().events];o[e(c)]={...o[e(c)]??{},eventType:t},a(a().events=o,!0)}function k(t){i();const o=[...a().events];o[e(c)]={...o[e(c)]??{},eventDate:t};let _=ra(o);_.sort((K, te)=>K.eventDate>te.eventDate),a(a().events=_,!0)}const ie= t=>!!(t?.eventType||t?.eventDate);le(()=>{Array.isArray(a().events)&&(a().events.length>0&&a().events.every(t=>!ie(t))&&(a(a().events=[],!0),u(c,0)),(a().events?.length??0)===0?u(c,0):e(c)>a().events.length-1&&u(c,a().events.length-1))});async function se(){console.log("loading students..."),u(D,await _e("/api/student"),!0)}async function S(){try{u(v,await _e("/api/study-program"),!0)}catch(t){console.error("Konnte Studiengänge nicht laden:",t),u(v,[],!0)}}oa(async()=>{await Promise.all([se(),S()])});var M=xa(),ae=r(M),ye=r(ae),Ee=n(r(ye),2),Ye=r(Ee),zt=r(Ye);ya(zt,{get data(){return e(D)},placeholder:"Suche",refresh:se,onClear:ne,get selectedStudent(){return e(h)},set selectedStudent(t){u(h,t,!0)}}),l(Ye),l(Ee);var Je=n(Ee,2),Qe=n(r(Je),2);Da(Qe,{get data(){return e(Z)},placeholder:"Studiengang suchen",get selectedStudyProgram(){return e(w)},onSelected:L,onCleared:$});var Kt=n(Qe,2);{var Gt= t=>{var o=wa(),_=r(o),K=r(_);l(_),l(o),R(()=>X(K,`${e(h).firstName??""} ${e(h).lastName??""}
                            studiert ${(e(x)||"-")??""}${e(y)?` (${e(y)})`:""}
                            .`)),A(t,o)};re(Kt,t=>{e(h)&&e(h).studyProgramId&&t(Gt)})}l(Je),l(ye);var ke=n(ye,4),qe=n(r(ke),2),Xe=n(r(qe),2),et=r(Xe);Ft(et),l(Xe),l(qe);var tt=n(qe,2),Se=r(tt),at=n(r(Se),2),lt=r(at);W(lt),l(at),l(Se);var rt=n(Se,2),nt=n(r(rt),2),it=r(nt);W(it),l(nt),l(rt),l(tt),l(ke);var Me=n(ke,4),De=n(r(Me),2),we=r(De),st=n(r(we),2),ot=r(st);W(ot),l(st),l(we);var Ie=n(we,2),vt=n(r(Ie),2),ut=r(vt);W(ut),l(vt),l(Ie);var dt=n(Ie,2),ct=n(r(dt),2),oe=r(ct),Ae=r(oe);Ae.value=Ae.__value="";var Te=n(Ae);Te.value=Te.__value="30";var Pe=n(Te);Pe.value=Pe.__value="45";var xe=n(Pe);xe.value=xe.__value="60";var Ce=n(xe);Ce.value=Ce.__value="75";var Ne=n(Ce);Ne.value=Ne.__value="90";var We=n(Ne);We.value=We.__value="105";var Be=n(We);Be.value=Be.__value="120";var je=n(Be);je.value=je.__value="135";var Le=n(je);Le.value=Le.__value="150";var $e=n(Le);$e.value=$e.__value="165";var mt=n($e);mt.value=mt.__value="180",l(oe);var pt;$t(oe),l(ct),l(dt),l(De);var Oe=n(De,2),Fe=r(Oe),gt=n(r(Fe),2),ft=r(gt);W(ft),l(gt),l(Fe);var Ve=n(Fe,2),_t=n(r(Ve),2),ht=r(_t);W(ht),l(_t),l(Ve);var Re=n(Ve,2),bt=n(r(Re),2),yt=r(bt);W(yt),l(bt),l(Re);var Et=n(Re,2),kt=n(r(Et),2),qt=r(kt);W(qt),l(kt),l(Et),l(Oe);var St=n(Oe,2),Mt=n(r(St),2),Dt=r(Mt);W(Dt),l(Mt),l(St),l(Me);var wt=n(Me,4),ze=r(wt),Ht=n(r(ze),2);{var Ut=t=>{var o=Aa(),_=r(o),K=n(_,2);he(K,17,()=>Array.from({length:e(E)},(te,ce)=>ce),be,(te,ce)=>{var me=Ia(),Qt=r(me);l(me),R(()=>{Rt(me,1,`pager-num ${e(ce)===e(c)?"active":""}`,"svelte-1vgudho"),X(Qt,`[${e(ce)+1}]`)}),Y("click",me,()=>s(e(ce))),A(te,me)}),l(o),R(()=>_.disabled=e(c)===0),Y("click",_,()=>s(e(c)-1)),A(t,o)};re(Ht,t=>{e(m)&&t(Ut)})}l(ze);var It=n(ze,2),Ke=r(It),At=n(r(Ke),2),ve=r(At),fe=r(ve);fe.value=fe.__value="";var Zt=n(fe);he(Zt,17,()=>q,be,(t,o)=>{var _=Ta(),K=r(_,!0);l(_);var te={};R(()=>{X(K,e(o).label),te!==(te=e(o).value)&&(_.value=(_.__value=e(o).value)??"")}),A(t,_)}),l(ve);var Tt;$t(ve),l(At),l(Ke);var Ge=n(Ke,2),Pt=n(r(Ge),2),He=r(Pt);W(He),l(Pt),l(Ge);var xt=n(Ge,2),Ct=n(r(xt),2),Nt=r(Ct),Yt=n(Nt,2);{var Jt=t=>{var o=Pa();Y("click",o,de),A(t,o)};re(Yt,t=>{e(m)&&t(Jt)})}l(Ct),l(xt),l(It),l(wt),l(ae),l(M),R(()=>{pt!==(pt=e(g))&&(oe.value=(oe.__value=e(g))??"",Ot(oe,e(g))),ia(fe,e(f).eventType===""),Tt!==(Tt=e(f).eventType)&&(ve.value=(ve.__value=e(f).eventType)??"",Ot(ve,e(f).eventType)),sa(He,e(f).eventDate)}),C(et,()=>a().title,t=>a(a().title=t,!0)),C(lt,()=>a().startDate,t=>a(a().startDate=t,!0)),C(it,()=>a().endDate,t=>a(a().endDate=t,!0)),C(ot,()=>d.tag,t=>d.tag=t),C(ut,()=>d.zeit,t=>d.zeit=t),Y("change",oe,t=>ee(t.target.value)),C(ft,()=>a().presentationStart,t=>a(a().presentationStart=t,!0)),C(ht,()=>a().presentationEnd,t=>a(a().presentationEnd=t,!0)),C(yt,()=>a().discussionStart,t=>a(a().discussionStart=t,!0)),C(qt,()=>a().discussionEnd,t=>a(a().discussionEnd=t,!0)),C(Dt,()=>a().colloquiumLocation,t=>a(a().colloquiumLocation=t,!0)),Y("change",ve,t=>I(t.target.value)),Y("input",He,t=>k(t.target.value)),Y("click",Nt,Q),A(V,M),ge()}var Na=T('<main class="erstellen-arbeit-container svelte-1vxvssb"><div class="header-row svelte-1vxvssb"><div class="page-title svelte-1vxvssb"> </div></div> <!> <!> <!> <div class="action-bar svelte-1vxvssb"><button class="cancel-btn svelte-1vxvssb" type="button">Abbrechen</button> <button class="save-btn svelte-1vxvssb" type="button"> </button></div></main>');function Ja(V,p){pe(p,!0);let a={};p.data.study_programs.forEach(s=>{a[s.id]=s.degreeType+" in "+s.title});let d={};p.data.students.forEach(s=>{d[s.id]=s});let g={};p.data.referenten.forEach(s=>{g[s.id]=s});let D=P(!0),h=P(0),v=P(ue({mainEvaluator:null,secondEvaluator:null,mainEvaluatorWorkMark:null,mainEvaluatorColloquiumMark:null,secondEvaluatorWorkMark:null,secondEvaluatorColloquiumMark:null,title:"",startDate:"",endDate:"",colloquium:null,colloquiumLocation:"",colloquiumDuration:null,presentationStart:"",presentationEnd:"",discussionStart:"",discussionEnd:"",studentId:null,studyProgramId:null,comment:"",events:[{eventType:"",eventDate:""}]})),b=P(ue([])),w=P(!1);function N(s){return!s||!p.data.referenten?null:p.data.referenten.find(i=>i.id===s)||{id:s}}function F(s){if(!s)return null;if(Array.isArray(s)){const[i,I,k]=s;return`${i}-${I.toString().padStart(2,"0")}-${k.toString().padStart(2,"0")}`}return s}function J(s){if(!s)return null;if(Array.isArray(s)){const[i,I,k,ie,se]=s;return`${i}-${I.toString().padStart(2,"0")}-${k.toString().padStart(2,"0")}T${ie.toString().padStart(2,"0")}:${se.toString().padStart(2,"0")}`}return s}async function B(s){try{const i=await _e(`/api/scientific-work/${s}`),I=await _e(`/api/scientific-work/${s}/events`);i&&(u(v,{...e(v),title:i.title,startDate:F(i.startDate),endDate:F(i.endDate),colloquium:J(i.colloquium),colloquiumLocation:i.colloquiumLocation,colloquiumDuration:i.colloquiumDuration,presentationStart:i.presentationStart,presentationEnd:i.presentationEnd,discussionStart:i.discussionStart,discussionEnd:i.discussionEnd,studentId:i.studentId,studyProgramId:i.studyProgramId,comment:i.comment,mainEvaluatorWorkMark:i.mainEvaluatorWorkMark,mainEvaluatorColloquiumMark:i.mainEvaluatorColloquiumMark,secondEvaluatorWorkMark:i.secondEvaluatorWorkMark,secondEvaluatorColloquiumMark:i.secondEvaluatorColloquiumMark,mainEvaluator:N(i.mainEvaluatorId),secondEvaluator:N(i.secondEvaluatorId),events:I&&I.length>0?I.map(k=>({...k,eventDate:F(k.eventDate)})):[{eventType:"",eventDate:""}]},!0),u(b,(I??[]).map(k=>k?.id).filter(k=>k!=null),!0))}catch(i){console.error("Fehler beim Laden der Arbeit:",i)}}let x=0;la(async()=>{const s=new URLSearchParams(window.location.search);if(s.has("id"))u(h,s.get("id"),!0),u(D,!1),await B(e(h)),x=e(h);else{const i=x!==0;u(D,!0),u(h,0),u(v,{mainEvaluator:null,secondEvaluator:null,mainEvaluatorWorkMark:null,mainEvaluatorColloquiumMark:null,secondEvaluatorWorkMark:null,secondEvaluatorColloquiumMark:null,title:"",startDate:"",endDate:"",colloquium:null,colloquiumLocation:"",colloquiumDuration:null,presentationStart:"",presentationEnd:"",discussionStart:"",discussionEnd:"",studentId:null,studyProgramId:null,comment:"",events:[{eventType:"",eventDate:""}]},!0),u(b,[],!0),x=0,i&&setTimeout(()=>{window.location.reload()},200)}});function y(s){const i=(s??"").toString().trim();return i===""?null:i}function G(){return{colloquium:e(v).colloquium??null,colloquiumLocation:y(e(v).colloquiumLocation),colloquiumDuration:e(v).colloquiumDuration??null,presentationStart:y(e(v).presentationStart),presentationEnd:y(e(v).presentationEnd),discussionStart:y(e(v).discussionStart),discussionEnd:y(e(v).discussionEnd),title:e(v).title,startDate:y(e(v).startDate),endDate:y(e(v).endDate),studentId:e(v).studentId??null,studyProgramId:e(v).studyProgramId??null,mainEvaluatorId:e(v).mainEvaluator?.id??null,secondEvaluatorId:e(v).secondEvaluator?.id??null,mainEvaluatorWorkMark:y(e(v).mainEvaluatorWorkMark),mainEvaluatorColloquiumMark:y(e(v).mainEvaluatorColloquiumMark),secondEvaluatorWorkMark:y(e(v).secondEvaluatorWorkMark),secondEvaluatorColloquiumMark:y(e(v).secondEvaluatorColloquiumMark),comment:y(e(v).comment)}}function H(s){return(e(v).events??[]).filter(i=>i.eventType&&i.eventDate).map(i=>({id:i.id,eventType:i.eventType,eventDate:i.eventDate,scientificWorkId:s}))}function U(){return!e(v).title||e(v).title.trim()===""?"Bitte einen Titel eingeben.":(e(v).events??[]).some(i=>i.eventType&&!i.eventDate||!i.eventType&&i.eventDate)?"Bitte bei jeder Veranstaltung Typ UND Datum ausfüllen.":null}async function Z(){const s=U();if(s){alert(s);return}if(!e(w)){u(w,!0);try{const i=G();let I=e(h);if(e(D)){const S=await Wt("/api/scientific-work",i);if(!S?.ok){alert("Fehler beim Erstellen der Arbeit.");return}const M=await S.json();I=M?.id??M?.scientificWorkId}else if(!(await Bt(`/api/scientific-work/${e(h)}`,i))?.ok){alert("Fehler beim Aktualisieren der Arbeit.");return}if(!I){alert("Fehler: Keine ID vorhanden.");return}const k=H(I),ie=new Set(k.map(S=>S.id).filter(Boolean)),se=(e(b)??[]).filter(S=>!ie.has(S));console.debug("Speichern: Events (DTO)",k),console.debug("Speichern: Zu löschende Event-IDs",se);for(const S of se)try{const M=await Xt(`/api/event/${S}`);if(M?.ok)console.debug(`Event gelöscht: ${S}`);else{const ae=await M.text().catch(()=>"");console.error(`Event-DELETE fehlgeschlagen (${S}):`,M?.status,ae)}}catch(M){console.error(`Fehler beim Löschen des Events ${S}:`,M)}for(const S of k)try{if(S.id){const M=await Bt(`/api/event/${S.id}`,S);if(!M?.ok){const ae=await M.text().catch(()=>"");console.error(`Event-PATCH fehlgeschlagen (${S.id}):`,M?.status,ae)}}else{const M=await Wt("/api/event",S);if(!M?.ok){const ae=await M.text().catch(()=>"");console.error("Event-POST fehlgeschlagen:",M?.status,ae)}}}catch(M){console.error("Fehler beim Speichern/Aktualisieren eines Events:",M)}u(b,k.map(S=>S.id).filter(Boolean),!0),jt("/arbeiten")}catch(i){console.error("Save failed:",i),alert("Fehler beim Speichern der Arbeit.")}finally{u(w,!1)}}}function c(){jt("/arbeiten")}var E=Na();aa("1vxvssb",s=>{ea(()=>{ta.title=`${e(D)?"Arbeit anlegen":"Arbeit bearbeiten"} - ProfIS`})});var m=r(E),f=r(m),q=r(f,!0);l(f),l(m);var j=n(m,2);na(j,{get swork(){return e(v)},get studmap(){return d},get progmap(){return a},get refmap(){return g}});var L=n(j,2);{let s=O(()=>p.data?.referenten??[]);ma(L,{get evaluators(){return e(s)},get data(){return e(v)},set data(i){u(v,i,!0)}})}var $=n(L,2);Ca($,{get data(){return e(v)},set data(s){u(v,s,!0)}});var ee=n($,2),ne=r(ee),Q=n(ne,2),de=r(Q,!0);l(Q),l(ee),l(E),R(()=>{X(q,e(D)?"ARBEIT ANLEGEN":"ARBEIT BEARBEITEN"),Q.disabled=e(w),X(de,e(w)?"Speichern...":e(D)?"Speichern":"Aktualisieren")}),Y("click",ne,c),Y("click",Q,Z),A(V,E),ge()}export{Ja as component,Ya as universal};
